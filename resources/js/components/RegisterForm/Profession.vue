<template>
  <h1 class="text__center " style="margin-top:0;">Great choice! Let's get a little more specific.</h1>
  <div class="progreess__bar--talent margin-b">
    <div class="progress__barLIne">
      <div class="blue_progress" style="width: 24%"></div>
    </div>
    <div class="progreess__barTitles_holder">
      <div class="bar__title bar__title--1 completed">
        <div class="title__svgIcon">
          <svg
            width="17"
            height="16"
            viewBox="0 0 17 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            style=""
          >
            <g clip-path="url(#clip0_649_769)">
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M8.3999 16C12.8182 16 16.3999 12.4183 16.3999 8C16.3999 3.58172 12.8182 0 8.3999 0C3.98162 0 0.399902 3.58172 0.399902 8C0.399902 12.4183 3.98162 16 8.3999 16Z"
                fill="white"
              ></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M8.3999 12C10.609 12 12.3999 10.2091 12.3999 8C12.3999 5.79086 10.609 4 8.3999 4C6.19076 4 4.3999 5.79086 4.3999 8C4.3999 10.2091 6.19076 12 8.3999 12Z"
                fill="#E0E0E7"
              ></path>
            </g>
            <defs>
              <clipPath id="clip0_649_769">
                <rect
                  width="16"
                  height="16"
                  fill="white"
                  transform="translate(0.399902)"
                ></rect>
              </clipPath>
            </defs>
          </svg>
          <svg
            width="17"
            height="16"
            viewBox="0 0 17 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M8.7998 16C13.2181 16 16.7998 12.4183 16.7998 8C16.7998 3.58172 13.2181 0 8.7998 0C4.38153 0 0.799805 3.58172 0.799805 8C0.799805 12.4183 4.38153 16 8.7998 16Z"
              fill="#578BEF"
            ></path>
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M13.7494 6.29289C14.1399 5.90236 14.1399 5.2692 13.7494 4.87867C13.3589 4.48815 12.7257 4.48815 12.3352 4.87867L7.38544 9.82842L5.26412 7.7071C4.8736 7.31658 4.24043 7.31658 3.84991 7.7071C3.45938 8.09763 3.45938 8.73079 3.84991 9.12131L6.67833 11.9497C7.06886 12.3403 7.70202 12.3403 8.09255 11.9497L13.7494 6.29289Z"
              fill="white"
            ></path>
          </svg>
        </div>
        Setect Role
      </div>
      <div class="bar__title bar__title--2 active">
        <div class="title__svgIcon">
          <svg
            width="17"
            height="16"
            viewBox="0 0 17 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            style=""
          >
            <g clip-path="url(#clip0_649_769)">
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M8.3999 16C12.8182 16 16.3999 12.4183 16.3999 8C16.3999 3.58172 12.8182 0 8.3999 0C3.98162 0 0.399902 3.58172 0.399902 8C0.399902 12.4183 3.98162 16 8.3999 16Z"
                fill="white"
              ></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M8.3999 12C10.609 12 12.3999 10.2091 12.3999 8C12.3999 5.79086 10.609 4 8.3999 4C6.19076 4 4.3999 5.79086 4.3999 8C4.3999 10.2091 6.19076 12 8.3999 12Z"
                fill="#E0E0E7"
              ></path>
            </g>
            <defs>
              <clipPath id="clip0_649_769">
                <rect
                  width="16"
                  height="16"
                  fill="white"
                  transform="translate(0.399902)"
                ></rect>
              </clipPath>
            </defs>
          </svg>
          
        </div>
        Select Industry
      </div>
      <div class="bar__title bar__title--4 ">
        <div class="title__svgIcon">
          <svg
            width="17"
            height="16"
            viewBox="0 0 17 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <g clip-path="url(#clip0_649_769)">
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M8.3999 16C12.8182 16 16.3999 12.4183 16.3999 8C16.3999 3.58172 12.8182 0 8.3999 0C3.98162 0 0.399902 3.58172 0.399902 8C0.399902 12.4183 3.98162 16 8.3999 16Z"
                fill="white"
              ></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M8.3999 12C10.609 12 12.3999 10.2091 12.3999 8C12.3999 5.79086 10.609 4 8.3999 4C6.19076 4 4.3999 5.79086 4.3999 8C4.3999 10.2091 6.19076 12 8.3999 12Z"
                fill="#E0E0E7"
              ></path>
            </g>
            <defs>
              <clipPath id="clip0_649_769">
                <rect
                  width="16"
                  height="16"
                  fill="white"
                  transform="translate(0.399902)"
                ></rect>
              </clipPath>
            </defs>
          </svg>
        </div>
        Tell us More
      </div>
      <div class="bar__title bar__title--5">
        <div class="title__svgIcon">
          <svg
            width="17"
            height="16"
            viewBox="0 0 17 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <g clip-path="url(#clip0_649_769)">
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M8.3999 16C12.8182 16 16.3999 12.4183 16.3999 8C16.3999 3.58172 12.8182 0 8.3999 0C3.98162 0 0.399902 3.58172 0.399902 8C0.399902 12.4183 3.98162 16 8.3999 16Z"
                fill="white"
              ></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M8.3999 12C10.609 12 12.3999 10.2091 12.3999 8C12.3999 5.79086 10.609 4 8.3999 4C6.19076 4 4.3999 5.79086 4.3999 8C4.3999 10.2091 6.19076 12 8.3999 12Z"
                fill="#E0E0E7"
              ></path>
            </g>
            <defs>
              <clipPath id="clip0_649_769">
                <rect
                  width="16"
                  height="16"
                  fill="white"
                  transform="translate(0.399902)"
                ></rect>
              </clipPath>
            </defs>
          </svg>
        </div>
        Account Manager
      </div>
      <div class="bar__title bar__title--6">
        <div class="title__svgIcon">
          <svg
            width="17"
            height="16"
            viewBox="0 0 17 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <g clip-path="url(#clip0_649_769)">
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M8.3999 16C12.8182 16 16.3999 12.4183 16.3999 8C16.3999 3.58172 12.8182 0 8.3999 0C3.98162 0 0.399902 3.58172 0.399902 8C0.399902 12.4183 3.98162 16 8.3999 16Z"
                fill="white"
              ></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M8.3999 12C10.609 12 12.3999 10.2091 12.3999 8C12.3999 5.79086 10.609 4 8.3999 4C6.19076 4 4.3999 5.79086 4.3999 8C4.3999 10.2091 6.19076 12 8.3999 12Z"
                fill="#E0E0E7"
              ></path>
            </g>
            <defs>
              <clipPath id="clip0_649_769">
                <rect
                  width="16"
                  height="16"
                  fill="white"
                  transform="translate(0.399902)"
                ></rect>
              </clipPath>
            </defs>
          </svg>
        </div>
        Review &amp; Done
      </div>
    </div>
  </div>
  <div class="regsiter_form_holder">
    <form action="#" class="">
      <div class="indutry__holder">
        <fieldset v-for="profession in professions" :key="profession.id">
          <input
            type="radio"
            name="id"
            :value="profession.id"
            v-model="id"
            :id="`indutsry__${profession.name}`"
            :checked="profession.id == id"
            @change="onChange"
          />
          <label :for="`indutsry__${profession.name}`">
            {{ profession.name }}</label
          >
        </fieldset>
      </div>
    </form>
  </div>

  <NextPreviousButton
    previousRouteName="SelectIndustry"
    nextRouteName="ProfileCrafting"
    :hasRouteAccess="hasRouteAccess"
  />
</template>
<script>
import NextPreviousButton from "../Buttons/NextPreviousButton.vue";
import chirrrpMeta from "@/Services/chirrpMetaService";
import { mapActions, mapState } from "vuex";
export default {
  name: "Profession",
  props: {
    title: String,
  },
  components: {
    NextPreviousButton,
  },
  computed: {
    ...mapState("chirrrpMeta", {
      professionID: (state) => state.chirrrpMeta.professionID,
      industries: (state) => state.chirrrpMeta.industries,
    }),
  },
  created() {
    let formData = this.$functions.getLocalStorage("mutlistepfm") || [];
    let industryId = formData ? formData.industryId : null;
    this.id = formData ? formData.profession_id : null;
    this.getProfession(industryId);
  },
  data() {
    return {
      isChecked: false,
      id: null,
      professions: {},
      id: this.$store.state.chirrrpMeta.profession_id,
      hasRouteAccess:true
    };
  },
  methods: {
    ...mapActions("chirrrpMeta", {
      getProfessions: "getProfessions",
    }),

    async getProfession(industryId) {
      let response = await this.getProfessions(industryId);
      this.professions = response;
      
      if(!Object.keys(this.professions).length){
        console.log("dss");
        this.hasRouteAccess = false;
      }
    },

    onChange() {
      let payload = {
        profession_id: this.id,
      };
      this.$functions.setLocalStorage("mutlistepfm", payload);
    },
  },
};
</script>
