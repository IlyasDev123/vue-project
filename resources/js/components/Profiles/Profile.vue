<template>
    <div class="site__header-user-profile">
        <div class="user__profile-img online">
            <img
                :src="authProfile?.avatar ? this.$public + authProfile?.avatar : this.$public + this.$dummy"
                alt=""
                @click="pofileShow"
            />

            <div class="user__popup show" v-show="isPofileShow">
                <div class="avatar__upload m__auto">
                    <div class="avatar__preview">
                        <div
                            id="imagePreview"
                            v-if="authProfile?.avatar"
                            :style="{
                                backgroundImage: `url('${ this.$public + authProfile?.avatar}')`,
                            }"
                        ></div>
                        <div
                            id="imagePreview"
                            v-else
                            :style="{
                                backgroundImage: 'url(' + this.$public + 'person-placeholder.jpg' + ')',
                            }"
                        ></div>
                    </div>
                </div>
                <h3>
                    {{
                        authProfile?.first_name + " " + authProfile?.last_name
                    }}
                </h3>
                <span v-if="authProfile.type == this.$constants.TALENT">Talent</span>
                <span v-if="authProfile.type == this.$constants.EMPLOYER">Employer</span>
                <span v-if="authProfile.type == this.$constants.RECURITER">Recruiter</span>
                <span v-if="authProfile.type == this.$constants.ADMIN">Admin</span>
                
                <div class="user__popup-link">
                    <router-link
                        :to="{ name: 'ProfileSettings' }"
                        class="d__flex d__flex-v-center d__flex-h-center"
                        @click="onClick"
                    >
                        <svg
                            width="15"
                            height="15"
                            viewBox="0 0 15 15"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M9.66572 0.619141L9.43135 0.712891L8.5876 1.04102L8.35322 1.13477L8.40947 1.37852L8.5876 2.27852C8.49971 2.36641 8.40596 2.46953 8.30635 2.57852L7.41572 2.38164L7.17197 2.32539L7.07822 2.55039L6.7126 3.39414L6.61885 3.61914L6.8251 3.75977L7.59385 4.27539C7.58447 4.42188 7.58564 4.56953 7.59385 4.71602L6.80635 5.20352L6.59072 5.33477L6.68447 5.56914L7.0126 6.41289L7.10635 6.64727L7.3501 6.59102L8.2501 6.41289C8.3415 6.52188 8.44228 6.62031 8.5501 6.71289L8.34385 7.61289L8.2876 7.85664L8.52197 7.95977L9.36572 8.31602L9.59072 8.40977L9.73135 8.20352L10.247 7.43477C10.3935 7.44414 10.5411 7.44297 10.6876 7.43477L11.1751 8.23164L11.3063 8.43789L11.5407 8.35352L12.6188 7.92227L12.5626 7.67852L12.3563 6.69414C12.4688 6.59922 12.5708 6.49727 12.6657 6.38477L13.5751 6.61914L13.8282 6.68477L13.922 6.45039L14.2876 5.60664L14.3907 5.37227L14.1657 5.23164L13.3782 4.75352C13.3876 4.60703 13.3864 4.45938 13.3782 4.31289L14.1657 3.82539L14.3813 3.69414L14.2876 3.45977L13.9595 2.61602L13.8657 2.38164L13.6126 2.43789L12.6938 2.64414C12.6024 2.53516 12.5017 2.43672 12.3938 2.34414L12.5907 1.44414L12.647 1.20039L12.422 1.10664L11.5782 0.741016L11.3438 0.647266L11.2032 0.862891L10.7251 1.62227C10.5868 1.6082 10.4368 1.62109 10.2845 1.63164L9.79697 0.834766L9.66572 0.619141ZM9.4126 1.35977L9.85322 2.08164L9.96572 2.25977L10.172 2.21289C10.3841 2.16602 10.5845 2.1918 10.8563 2.22227L11.0438 2.24102L11.147 2.08164L11.5782 1.39727L11.9532 1.55664L11.7657 2.36289L11.7188 2.55977L11.8876 2.67227C12.0716 2.80352 12.2251 2.95703 12.3563 3.14102L12.4688 3.30977L12.6657 3.26289L13.4907 3.07539L13.6407 3.45039L12.9188 3.88164L12.7595 3.98477L12.7782 4.17227C12.8063 4.42305 12.8063 4.63398 12.7782 4.88477L12.7595 5.07227L12.9188 5.17539L13.6313 5.61602L13.4813 5.97227L12.647 5.76602L12.4407 5.71914L12.3282 5.88789C12.197 6.07188 12.0435 6.22539 11.8595 6.35664L11.7001 6.46914L11.7376 6.66602L11.9251 7.55664L11.5501 7.69727L11.1188 6.98477L11.0157 6.82539L10.8282 6.84414C10.5774 6.87227 10.3665 6.87227 10.1157 6.84414L9.92822 6.82539L9.83447 6.97539L9.3751 7.66914L8.99072 7.50039L9.16885 6.69414L9.21572 6.50664L9.05635 6.38477C8.87236 6.25352 8.71885 6.1 8.5876 5.91602L8.4751 5.75664L8.27822 5.79414L7.47197 5.96289L7.33135 5.58789L8.04385 5.14727L8.2126 5.04414L8.18447 4.85664C8.15635 4.60586 8.15635 4.39492 8.18447 4.14414L8.2126 3.96602L8.05322 3.86289L7.35947 3.40352L7.51885 3.01914L8.33447 3.20664L8.5126 3.24414L8.6251 3.10352C8.79619 2.9043 8.97197 2.72852 9.12197 2.57852L9.23447 2.46602L9.20635 2.31602L9.0376 1.50977L9.4126 1.35977ZM10.5001 3.00039C9.6751 3.00039 9.0001 3.67539 9.0001 4.50039C9.0001 5.32539 9.6751 6.00039 10.5001 6.00039C11.3251 6.00039 12.0001 5.32539 12.0001 4.50039C12.0001 3.67539 11.3251 3.00039 10.5001 3.00039ZM10.5001 3.60039C11.0005 3.60039 11.4001 4 11.4001 4.50039C11.4001 5.00078 11.0005 5.40039 10.5001 5.40039C9.99971 5.40039 9.6001 5.00078 9.6001 4.50039C9.6001 4 9.99971 3.60039 10.5001 3.60039ZM4.05947 6.00039L4.02197 6.25352L3.87197 7.22852C3.70908 7.28008 3.55205 7.35508 3.40322 7.43477L2.37197 6.68477L1.32197 7.73477L1.4626 7.94102L2.03447 8.76602C1.95361 8.92656 1.88213 9.08711 1.82822 9.24414L0.843848 9.42227L0.600098 9.46914V10.9316L0.843848 10.9785L1.82822 11.1566C1.88096 11.3207 1.95361 11.4742 2.03447 11.6254L1.44385 12.4223L1.28447 12.6285L2.33447 13.6785L2.54072 13.5379L3.36572 12.966C3.52627 13.0469 3.68682 13.1184 3.84385 13.1723L3.99385 14.1473L4.03135 14.4004H5.50322L5.54072 14.1566L5.72822 13.1723C5.89111 13.1207 6.04814 13.0457 6.19697 12.966L7.22822 13.716L8.27822 12.666L8.1376 12.4598L7.5376 11.6254C7.61611 11.4672 7.69111 11.3113 7.74385 11.1566L8.75635 10.9785L9.0001 10.9316V9.45977L7.73447 9.27227C7.68291 9.11055 7.61728 8.95234 7.5376 8.80352L8.1376 7.97852L8.27822 7.77227L8.10947 7.59414L7.41572 6.87227L7.2376 6.68477L7.02197 6.83477L6.19697 7.43477C6.03877 7.35625 5.88291 7.28125 5.72822 7.22852L5.57822 6.25352L5.54072 6.00039H4.05947ZM4.5751 6.60039H5.0251L5.19385 7.66914L5.3626 7.72539C5.63213 7.81563 5.88408 7.9 6.08447 8.02539L6.25322 8.12852L6.4126 8.01602L7.1626 7.47227L7.5001 7.82852L6.95635 8.58789L6.83447 8.74727L6.94697 8.91602C7.08174 9.13164 7.18721 9.38125 7.2376 9.60977L7.28447 9.80664L7.48135 9.83477L8.4001 9.97539V10.4348L7.48135 10.5941L7.30322 10.6223L7.24697 10.791C7.15674 11.0605 7.07236 11.3125 6.94697 11.5129L6.83447 11.6816L6.95635 11.841L7.5001 12.6004L7.1626 12.9285L6.4126 12.3848L6.25322 12.2723L6.08447 12.3754C5.86885 12.5102 5.61924 12.6156 5.39072 12.666L5.20322 12.7129L5.16572 12.9098L5.00635 13.8004H4.54697L4.37822 12.7316L4.20947 12.6754C3.93994 12.5852 3.68799 12.5008 3.4876 12.3754L3.31885 12.2723L3.15947 12.3848L2.4001 12.9004L2.07197 12.5723L2.60635 11.8504L2.7376 11.6816L2.6251 11.5129C2.49033 11.2973 2.38486 11.057 2.33447 10.8285L2.2876 10.6316L2.09072 10.5941L1.2001 10.4348V9.96602L2.09072 9.80664L2.26885 9.76914L2.3251 9.60977C2.41533 9.34023 2.49971 9.08828 2.6251 8.88789L2.72822 8.71914L2.61572 8.55977L2.1001 7.80039L2.4376 7.47227L3.1876 8.01602L3.34697 8.12852L3.51572 8.02539C3.73135 7.89062 3.98096 7.78516 4.20947 7.73477L4.40635 7.68789L4.43447 7.49102L4.5751 6.60039ZM4.8001 8.70039C3.97627 8.70039 3.3001 9.37656 3.3001 10.2004C3.3001 11.0242 3.97627 11.7004 4.8001 11.7004C5.62393 11.7004 6.3001 11.0242 6.3001 10.2004C6.3001 9.37656 5.62393 8.70039 4.8001 8.70039ZM4.8001 9.30039C5.29697 9.30039 5.7001 9.70352 5.7001 10.2004C5.7001 10.6973 5.29697 11.1004 4.8001 11.1004C4.30322 11.1004 3.9001 10.6973 3.9001 10.2004C3.9001 9.70352 4.30322 9.30039 4.8001 9.30039Z"
                                fill="black"
                            />
                        </svg>
                        <span>Account Settings</span>
                    </router-link>
                </div>
            </div>
        </div>
    </div>
</template>

<script>
import Auth from "../../auth";
import userService from "../../Services/userService.js";
import { mapState } from "vuex";
export default {
    name: "Profile",

    data() {
        return {
            shouldShowModal: false,
            isPofileShow: false,
            profile: [],
            userType: "",
        };
    },
    created() {
        this.closeModal();
        // this.getUserProfile();
        this.userType = Auth.user.type;
    },
    computed: {
        ...mapState("auth", {
            authProfile : (state) => state.user,
        }),
    },
    mounted() {},
    methods: {
        getUserProfile() {
            userService
                .getProfile()
                .then((data) => {
                    if (data.data.status == true) {
                        authProfile = data.data.data;
                    }
                })
                .catch((error) => {
                    this.$toast.error(error.response.data.message);
                });
        },
        closeModal() {
            window.addEventListener("click", (e) => {
                if (!this.$el.contains(e.target)) {
                    this.isPofileShow = false;
                }
            });
        },
        pofileShow() {
            this.isPofileShow = this.isPofileShow == false ? true : false;
        },
        hidePopup() {
            this.shouldShowModal = false;
        },
        onClick() {
            this.isPofileShow = false;
        },
    },
};
</script>

<style lang="scss" scoped></style>
